@Test
void testIngestReportToFolder_WhenAddReturnsNull_ThrowsException() throws Exception {

    when(mockPool.borrowObject()).thenReturn(mockAbstractODServer);
    when(mockAbstractODServer.addReportToFolder(any(), any(), any(), any(), any()))
            .thenReturn(null);

    CMODConnectionManager fakeMgr = mock(CMODConnectionManager.class);

    try (MockedStatic<CMODConnectionManager> mockedStatic =
            Mockito.mockStatic(CMODConnectionManager.class)) {

        mockedStatic.when(CMODConnectionManager::getInstance)
                .thenReturn(fakeMgr);

        when(fakeMgr.getODServerPool(any(), any(), any()))
                .thenReturn(mockPool);

        assertThrows(ODFailureException.class, () ->
                odServiceNative.ingestReportToFolder(
                        "testPortal", "client", "folder",
                        "Test".getBytes(), "group", "app",
                        new String[]{}, new Hashtable<>()
                )
        );

        verify(mockPool).returnObject(mockAbstractODServer);
    }
}
